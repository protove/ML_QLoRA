2025-11-05 15:56:36 - INFO - ================================================================================
2025-11-05 15:56:36 - INFO - QLoRA Fine-tuning for RTX 3080
2025-11-05 15:56:36 - INFO - Mistral-7B 모델 학습 스크립트
2025-11-05 15:56:36 - INFO - ================================================================================
2025-11-05 15:56:36 - INFO - 실험 폴더: qlora-mistral-3080-final/0004
2025-11-05 15:56:36 - INFO - PyTorch 버전: 2.5.1+cu121
2025-11-05 15:56:36 - INFO - CUDA 사용 가능: True
2025-11-05 15:56:36 - INFO - GPU: NVIDIA GeForce RTX 3080
2025-11-05 15:56:36 - INFO - CUDA 버전: 12.1
2025-11-05 15:56:36 - INFO - 
--------------------------------------------------------------------------------
2025-11-05 15:56:36 - INFO - 1. 토크나이저 로드 중...
2025-11-05 15:56:36 - INFO - --------------------------------------------------------------------------------
2025-11-05 15:56:37 - INFO - ✓ 토크나이저 로드 완료
2025-11-05 15:56:37 - INFO -   모델: mistralai/Mistral-7B-v0.1
2025-11-05 15:56:37 - INFO -   Vocabulary 크기: 32000
2025-11-05 15:56:37 - INFO - 
--------------------------------------------------------------------------------
2025-11-05 15:56:37 - INFO - 2. QLoRA 설정 중...
2025-11-05 15:56:37 - INFO - --------------------------------------------------------------------------------
2025-11-05 15:56:37 - INFO - ✓ QLoRA 설정 완료
2025-11-05 15:56:37 - INFO -   - 4비트 양자화: 활성화
2025-11-05 15:56:37 - INFO -   - 양자화 타입: NF4
2025-11-05 15:56:37 - INFO -   - 계산 타입: bfloat16
2025-11-05 15:56:37 - INFO -   - 이중 양자화: 활성화
2025-11-05 15:56:37 - INFO - 
--------------------------------------------------------------------------------
2025-11-05 15:56:37 - INFO - 3. 모델 로드 중... (시간이 걸릴 수 있습니다)
2025-11-05 15:56:37 - INFO - --------------------------------------------------------------------------------
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:04<00:04,  4.97s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.57s/it]
2025-11-05 15:56:45 - INFO - ✓ 모델 로드 완료
2025-11-05 15:56:45 - INFO -   모델 타입: MistralForCausalLM
2025-11-05 15:56:45 - INFO -   디바이스: cuda:0
2025-11-05 15:56:45 - INFO - 
--------------------------------------------------------------------------------
2025-11-05 15:56:45 - INFO - 4. LoRA 설정 중...
2025-11-05 15:56:45 - INFO - --------------------------------------------------------------------------------
2025-11-05 15:56:45 - INFO - ✓ LoRA 설정 완료
2025-11-05 15:56:45 - INFO -   - 랭크(r): 8
2025-11-05 15:56:45 - INFO -   - 알파: 16
2025-11-05 15:56:45 - INFO -   - 드롭아웃: 0.05
2025-11-05 15:56:45 - INFO -   - 대상 모듈 수: 7
2025-11-05 15:56:45 - INFO - 
--------------------------------------------------------------------------------
2025-11-05 15:56:45 - INFO - 5. PEFT 모델 준비 중...
2025-11-05 15:56:45 - INFO - --------------------------------------------------------------------------------
2025-11-05 15:56:46 - INFO - ✓ PEFT 모델 준비 완료
2025-11-05 15:56:46 - INFO -   학습 가능한 파라미터: 20,971,520
2025-11-05 15:56:46 - INFO -   전체 파라미터: 3,773,042,688
2025-11-05 15:56:46 - INFO -   학습 가능 비율: 0.5558%
2025-11-05 15:56:46 - INFO -   GPU 메모리 할당: 4.41 GB
2025-11-05 15:56:46 - INFO -   GPU 메모리 예약: 5.21 GB
2025-11-05 15:56:46 - INFO - 
--------------------------------------------------------------------------------
2025-11-05 15:56:46 - INFO - 6. 데이터셋 로드 중...
2025-11-05 15:56:46 - INFO - --------------------------------------------------------------------------------
2025-11-05 15:56:48 - INFO - ✓ 데이터셋 로드 완료
2025-11-05 15:56:48 - INFO -   - 샘플 수: 15011
2025-11-05 15:56:48 - INFO -   - 컬럼: ['instruction', 'context', 'response', 'category']
2025-11-05 15:56:48 - INFO - 토크나이징 중...
Map:   0%|          | 0/15011 [00:00<?, ? examples/s]Map:   2%|▏         | 355/15011 [00:00<00:04, 3525.92 examples/s]Map:   5%|▍         | 714/15011 [00:00<00:04, 3552.82 examples/s]Map:   8%|▊         | 1175/15011 [00:00<00:04, 2921.08 examples/s]Map:  10%|█         | 1509/15011 [00:00<00:04, 3025.33 examples/s]Map:  12%|█▏        | 1870/15011 [00:00<00:04, 3206.17 examples/s]Map:  15%|█▌        | 2320/15011 [00:00<00:04, 2836.98 examples/s]Map:  18%|█▊        | 2698/15011 [00:00<00:04, 3076.45 examples/s]Map:  21%|██        | 3156/15011 [00:01<00:04, 2794.75 examples/s]Map:  23%|██▎       | 3504/15011 [00:01<00:03, 2955.12 examples/s]Map:  26%|██▌       | 3867/15011 [00:01<00:03, 3122.50 examples/s]Map:  29%|██▉       | 4357/15011 [00:01<00:03, 2879.20 examples/s]Map:  31%|███▏      | 4719/15011 [00:01<00:03, 3051.05 examples/s]Map:  35%|███▍      | 5193/15011 [00:01<00:03, 2906.20 examples/s]Map:  37%|███▋      | 5564/15011 [00:01<00:03, 3089.36 examples/s]Map:  39%|███▉      | 5919/15011 [00:01<00:02, 3201.90 examples/s]Map:  42%|████▏     | 6352/15011 [00:02<00:02, 2921.92 examples/s]Map:  44%|████▍     | 6676/15011 [00:02<00:02, 2994.61 examples/s]Map:  47%|████▋     | 7000/15011 [00:02<00:02, 2738.30 examples/s]Map:  49%|████▉     | 7358/15011 [00:02<00:02, 2942.18 examples/s]Map:  51%|█████▏    | 7714/15011 [00:02<00:02, 3101.21 examples/s]Map:  54%|█████▍    | 8158/15011 [00:02<00:02, 2841.20 examples/s]Map:  57%|█████▋    | 8498/15011 [00:02<00:02, 2974.99 examples/s]Map:  59%|█████▉    | 8862/15011 [00:02<00:01, 3138.94 examples/s]Map:  62%|██████▏   | 9318/15011 [00:03<00:02, 2819.89 examples/s]Map:  64%|██████▍   | 9664/15011 [00:03<00:01, 2966.60 examples/s]Map:  67%|██████▋   | 9993/15011 [00:03<00:01, 3046.46 examples/s]Map:  70%|██████▉   | 10472/15011 [00:03<00:01, 2754.48 examples/s]Map:  72%|███████▏  | 10851/15011 [00:03<00:01, 2988.57 examples/s]Map:  76%|███████▌  | 11334/15011 [00:03<00:01, 2796.45 examples/s]Map:  78%|███████▊  | 11691/15011 [00:03<00:01, 2965.94 examples/s]Map:  81%|████████  | 12163/15011 [00:04<00:01, 2759.83 examples/s]Map:  83%|████████▎ | 12524/15011 [00:04<00:00, 2944.72 examples/s]Map:  86%|████████▌ | 12865/15011 [00:04<00:00, 3054.23 examples/s]Map:  89%|████████▉ | 13350/15011 [00:04<00:00, 2850.13 examples/s]Map:  91%|█████████▏| 13703/15011 [00:04<00:00, 3003.15 examples/s]Map:  94%|█████████▍| 14161/15011 [00:04<00:00, 2786.62 examples/s]Map:  97%|█████████▋| 14512/15011 [00:04<00:00, 2943.22 examples/s]Map:  99%|█████████▉| 14876/15011 [00:05<00:00, 3109.91 examples/s]Map: 100%|██████████| 15011/15011 [00:05<00:00, 2834.45 examples/s]
2025-11-05 15:56:53 - INFO - ✓ 토크나이징 완료
2025-11-05 15:56:53 - INFO -   - 최대 길이: 512 토큰
2025-11-05 15:56:53 - INFO - 
--------------------------------------------------------------------------------
2025-11-05 15:56:53 - INFO - 7. Training Arguments 설정 중...
2025-11-05 15:56:53 - INFO - --------------------------------------------------------------------------------
2025-11-05 15:56:54 - INFO - ✓ Training Arguments 설정 완료
2025-11-05 15:56:54 - INFO -   - 배치 크기: 1
2025-11-05 15:56:54 - INFO -   - Gradient Accumulation: 16
2025-11-05 15:56:54 - INFO -   - 실질 배치 크기: 16
2025-11-05 15:56:54 - INFO -   - 학습률: 0.0002
2025-11-05 15:56:54 - INFO -   - 스케줄러: cosine
2025-11-05 15:56:54 - INFO -   - 에포크: 5
2025-11-05 15:56:54 - INFO - ✓ 설정 파일 저장 완료: qlora-mistral-3080-final/0004/config.json
2025-11-05 15:56:54 - INFO - ✓ 설정 파일 저장 완료: qlora-mistral-3080-final/0004/config.txt
2025-11-05 15:56:54 - INFO - 
--------------------------------------------------------------------------------
2025-11-05 15:56:54 - INFO - 8. Trainer 초기화 중...
2025-11-05 15:56:54 - INFO - --------------------------------------------------------------------------------
2025-11-05 15:56:54 - INFO - ✓ Trainer 초기화 완료
2025-11-05 15:56:54 - INFO - 
================================================================================
2025-11-05 15:56:54 - INFO - 9. 학습 시작 🚀
2025-11-05 15:56:54 - INFO - ================================================================================

2025-11-05 15:56:54 - INFO - ================================================================================
2025-11-05 15:56:54 - INFO - 🚀 학습 시작!
2025-11-05 15:56:54 - INFO - ================================================================================
  0%|          | 0/4695 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  0%|          | 1/4695 [00:15<20:31:16, 15.74s/it]  0%|          | 2/4695 [00:31<20:27:10, 15.69s/it]  0%|          | 3/4695 [00:47<20:25:08, 15.67s/it]  0%|          | 4/4695 [01:02<20:24:45, 15.67s/it]  0%|          | 5/4695 [01:18<20:24:53, 15.67s/it]  0%|          | 6/4695 [01:34<20:23:57, 15.66s/it]  0%|          | 7/4695 [01:49<20:25:29, 15.68s/it]  0%|          | 8/4695 [02:05<20:27:36, 15.72s/it]  0%|          | 9/4695 [02:21<20:27:05, 15.71s/it]  0%|          | 10/4695 [02:36<20:27:37, 15.72s/it]2025-11-05 15:59:31 - INFO - Step 10/4695 | Loss: 1.2727 | LR: 2.00e-04 | Epoch: 0.01 | GPU: 4.50GB
                                                      0%|          | 10/4695 [02:36<20:27:37, 15.72s/it]  0%|          | 11/4695 [02:52<20:26:55, 15.72s/it]  0%|          | 12/4695 [03:08<20:27:14, 15.72s/it]  0%|          | 13/4695 [03:24<20:26:35, 15.72s/it]  0%|          | 14/4695 [03:39<20:27:54, 15.74s/it]  0%|          | 15/4695 [03:55<20:27:47, 15.74s/it]  0%|          | 16/4695 [04:11<20:28:27, 15.75s/it]  0%|          | 17/4695 [04:27<20:26:59, 15.74s/it]  0%|          | 18/4695 [04:42<20:25:51, 15.73s/it]